angular.module("ngSharepoint",[]),angular.module("ngSharepoint").factory("CamlBuilder",["CamlTag",function(a){var b=function(){this.camlQuery=new SP.CamlQuery,this.caml=[]};return b.prototype.push=function(b,c,d){if(b instanceof a)this.caml.push(b);else{var e=new a(b,c,d);this.caml.push(e)}},b.prototype.findByName=function(a){var b=[];return this.caml.forEach(function(c){c.name==a&&b.push(c)}),b},b.prototype.build=function(){for(var a=0;0>a;a++)this.caml[a]=this.caml[a].build();return this.camlQuery.set_viewXml(this.caml.join("")),this.camlQuery},b}]),angular.module("ngSharepoint").factory("CamlTag",function(){var a=function(a,b,c){this.name=a,this.attr=b||{},this.value=c||void 0,this.caml=[]};return a.prototype.__buildTag=function(){var a=this,b="<";return b+=a.name,Object.getOwnPropertyNames(a.attr).length>0&&Object.getOwnPropertyNames(a.attr).forEach(function(c){b+=" ",b+=c,b+="=",b+='"'+a.attr[c]+'"'}),0===this.caml.length&&angular.isUndefined(this.value)?b+="/>":(b+=">",angular.isDefined(this.value)&&(b+=this.value)),b},a.prototype.push=function(b,c){if(b instanceof a)this.caml.push(b);else{var d=new a(b,c);this.caml.push(d)}},a.prototype.setVal=function(a){this.value=a},a.prototype.build=function(){for(var a=this.__buildTag(),b=0;b<this.caml.length;b++)a+=this.caml[b].build();return(this.caml.length>0||angular.isDefined(this.value))&&(a+="</"+this.name+">"),a},a}),angular.module("ngSharepoint").provider("$sp",function(){var a="";return{setSiteUrl:function(b){a=b},setConnectionMode:function(a){("JSOM"==a||"REST"==a)&&(this.connMode=a)},$get:function(){return{getSiteUrl:function(){return a},getContext:function(){return new SP.ClientContext(a)}}}}});