angular.module("ngSharepoint.Users",["ngSharepoint"]).run(["$sp","$spLoader",function(a,b){a.getAutoload()&&"JSOM"===a.getConnectionMode()&&b.loadScript("SP.Userprofiles.js")}]),angular.module("ngSharepoint.Users").factory("JsomSPUser",["$q","$sp","$spLoader",function(a,b,c){var d=function(a){this.accountName=a};return d.prototype.load=function(){var d=this;return a(function(a,e){c.waitUntil("SP.Userprofiles.js").then(function(){var c=b.getContext(),f=new SP.UserProfiles.PeopleManager(c),g=f.getPropertiesFor(d.accountName);c.load(g),c.executeQueryAsync(function(){var b={};b.displayName=g.get_displayName(),b.email=g.get_email(),b.picture=g.get_pictureUrl(),b.title=g.get_title(),b.personalUrl=g.get_personalUrl(),b.userUrl=g.get_userUrl(),a(b)},e)})})},d}]),angular.module("ngSharepoint.Users").factory("RestSPUser",["$q","$spLoader",function(a,b){var c=function(a){this.accountName=a};return c.prototype.load=function(){var c=this,d="_api/SP.UserProfiles.PeopleManager/getPropertiesFor(@account)?@account='"+c.accountName+"'";return a(function(a,c){b({method:"GET",url:d}).then(function(b){var c={};c.displayName=b.d.DisplayName,c.email=b.d.Email,c.picture=b.d.PictureUrl,c.title=b.d.Title,c.personalUrl=b.d.PersonalUrl,c.userUrl=b.d.UserUrl,a(c)},c)})},c}]),angular.module("ngSharepoint.Users").factory("SPUser",["$q","$spLoader","$sp","JsomSPUser","RestSPUser",function(a,b,c,d,e){var f=function(a,b){var f=this;return angular.isUndefined(b)&&(b=!0),f.accountName=a,"JSOM"===c.getConnectionMode()?f.__user=new d(a):f.__user=new e(a),b?f.load().then(function(a){f.from(a)}):f};return f.prototype.from=function(a){this.displayName=a.displayName,this.email=a.email,this.picture=a.picture,this.title=a.title,this.personalUrl=a.personalUrl,this.userUrl=a.userUrl,this.properties=a.properties},f.prototype.load=function(){return this.__user.load()},f}]),angular.module("ngSharepoint.Users").factory("$spUser",["$q","$sp","SPUser",function(a,b,c){return{getCurrentUser:function(){return a(function(a,c){var d=b.getContext(),e=new SP.UserProfiles.PeopleManager(d),f=e.getMyProperties();d.load(f),d.executeQueryAsync(function(){a(f)},c)})},getUser:function(a){return new c(a)}}}]);