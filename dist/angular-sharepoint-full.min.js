function $spProvider(){function a(a){f=a}function b(a){("JSOM"===a||"REST"===a)&&(g=a)}function c(a){h=a}function d(a){i=a}function e(){function a(){return new SP.ClientContext}function b(){return f}function c(){return g}function d(){return h}function e(){return i}var j={getSiteUrl:b,getConnectionMode:c,getAccessToken:d,getContext:a,getAutoload:e};return j}var f="",g="JSOM",h=!1,i=!0,j={setSiteUrl:a,setConnectionMode:b,setAccessToken:c,setAutoload:d,$get:e};return j}function $query(a){var b=function(){this.columns=[],this.list=void 0,this.type=void 0,this.query=void 0,this.data={},this.read=function(a){if(!angular.isUndefined(this.type))throw"Cannot use read after another query type was selected";return angular.isUndefined(a)&&(a="*"),this.columns=a,this.type="read",this},this.create=function(a){if(!angular.isUndefined(this.type))throw"Cannot use create after another query type was selected";return this.type="create",angular.isDefined(a)&&(this.data=a),this},this.from=function(a){return this.list=a,this},this.into=function(a){return this.list=a,this},this.list=function(a){return this.list=a,this},this.update=function(a){if(!angular.isUndefined(this.type))throw"Cannot use update after another query type was selected";return this.type="update",angular.isDefined(a)&&(this.data=a),this},this["delete"]=function(){if(!angular.isUndefined(this.type))throw"Cannot use delete after another query type was selected";return this.type="delete",this},this.where=function(a){var b=function(a,b){this.equals=function(c){return b.query={comparator:"equals",column:a,value:c},b}};return new b(a,this)},this.set=function(a,b){return this.data[a]=b,this},this.value=function(a,b){return this.data[a]=b,this},this.exec=function(){return a.getList(this.list).query(this)},this.then=function(a,b){return this.exec().then(a,b)}};return{create:function(a){return(new b).create(a)},read:function(a){return(new b).read(a)},update:function(){return(new b).update()},"delete":function(){return(new b)["delete"]()}}}function $spList(a,b,c,d){function e(a){return new b(a)}function f(){var e;return e="JSOM"===a.getConnectionMode()?c.getLists():d.getLists(),e.then(function(a){var c=[];return a.forEach(function(a){c.push(new b(a))}),c})}var g={getList:e,getLists:f};return g}angular.module("ngSharepoint",[]).run(["$sp","$spLoader",function(a,b){if(a.getAutoload())if("JSOM"===a.getConnectionMode()){var c=["//ajax.aspnetcdn.com/ajax/4.0/1/MicrosoftAjax.js","SP.Runtime.js","SP.js"];b.loadScripts("SP.Core",c)}else"REST"!==a.getConnectionMode()||a.getAccessToken()||b.loadScript("SP.RequestExecutor.js")}]),angular.module("ngSharepoint").factory("CamlBuilder",["CamlTag",function(a){var b=function(){this.caml=[]};return b.prototype.push=function(b,c,d){var e;return e=b instanceof a?b:new a(b,c,d),this.caml.push(e),e},b.prototype.findByName=function(a){var b=[];return this.caml.forEach(function(c){c.name===a&&b.push(c)}),b},b.prototype.build=function(){for(var a=0;a<this.caml.length;a++)this.caml[a]=this.caml[a].build();return this.caml.join("")},b.prototype.buildFromJson=function(a){var b=this.findByName("View");b=0===b.length?this.push("View"):b[0],angular.isDefined(a.columns)&&this.__buildViewFields(a.columns,b),angular.isDefined(a.query)&&this.__buildQuery(a.query,b),angular.isDefined(a.limit)&&this.__buildLimit(a.limit,b),angular.isDefined(a.order)&&this.__buildOrder(a.order,b)},b.prototype.__buildViewFields=function(a,b){var c=b.push("ViewFields");a.forEach(function(a){c.push("FieldRef",{Name:a})})},b.prototype.__buildQuery=function(a,b){var c=this;if("View"===b.name&&(b=b.push("Query").push("Where")),angular.isDefined(a.concat)){var d;if("and"===a.concat)d=b.push("And");else{if("or"!==a.concat)throw"Invalid Query";d=b.push("Or")}a.queries.forEach(function(a){c.__buildQuery(a,d)})}else{if(!angular.isDefined(a.comparator))throw"Invalid Query";a.comparator=a.comparator.toLowerCase();var e;switch(a.comparator){case"beginswith":e=b.push("BeginsWith");break;case"contains":e=b.push("Contains");break;case"daterangesoverlap":e=b.push("DateRangesOverlap");break;case"==":case"eq":case"equals":e=b.push("Eq");break;case">=":case"geq":case"greaterequals":e=b.push("Geq");break;case">":case"gt":case"greater":e=b.push("Gt");break;case"in":e=b.push("In");break;case"includes":e=b.push("Includes");break;case"isnotnull":e=b.push("IsNotNull");break;case"isnull":e=b.push("IsNull");break;case"<=":case"leq":case"lessequals":e=b.push("Leq");break;case"<":case"lt":case"less":e=b.push("Lt");break;case"!=":case"neq":case"notequals":e=b.push("Neq");break;case"notincludes":e=b.push("NotIncludes")}e.push("FieldRef",{Name:a.column}),angular.isDefined(a.value)&&e.push("Value",{},a.value)}},b.prototype.__buildLimit=function(a,b){b.push("RowLimit",{},a)},b.prototype.__buildOrder=function(a,b){var c=b.findByName("Query");c=0===c.length?b.push("Query"):c[0];var d=c.push("OrderBy");a.forEach(function(a){if(!angular.isDefined(a.column))throw"Invalid Order Query";var b=!0;angular.isDefined(a.asc)&&(b=a.asc),b=b.toString().toUpperCase(),d.push("FieldRef",{Name:a.column,Ascending:b})})},b}]),angular.module("ngSharepoint").factory("$spCamlParser",function(){var a=function(a){var b=this;b.viewFields=[],b.query=a,b.where={},b.orderBy=[],b.limit=-1,b.doc=(new DOMParser).parseFromString(a,"text/xml");var c=b.doc.getElementsByTagName("ViewFields");if(1===c.length)for(var d=c[0].getElementsByTagName("FieldRef"),e=0;e<d.length;e++){var f=d[e];b.viewFields.push(f.attributes.Name.value)}var g=b.doc.getElementsByTagName("Query");if(1===g.length)for(var h=g[0],i=0;i<h.childNodes.length;i++){var j=h.childNodes[i];("Where"===j.nodeName||"And"===j.nodeName||"Or"===j.nodeName)&&b.__parseWhere(j,b.where)}var k=b.doc.getElementsByTagName("RowLimit");return 1===k.length&&(b.limit=parseInt(k[0].childNodes[0].nodeValue)),b};return a.prototype.__parseWhere=function(a,b){var c=this,d={};if("Where"===a.nodeName){var e=a.childNodes[0];d.operator=e.nodeName,d.column=e.getElementsByTagName("FieldRef")[0].attributes.Name.value,d.value=e.getElementsByTagName("Value")[0].childNodes[0].nodeValue}else if("And"===a.nodeName||"Or"===a.nodeName){d.concat=a.nodeName,d.queries=[];for(var f=0;f<a.childNodes.length;f++)c.__parseWhere(a.childNodes[f],d.queries)}angular.isArray(b)?b.push(d):Object.getOwnPropertyNames(d).forEach(function(a){b[a]=d[a]})},a.prototype.getViewFields=function(){return this.viewFields},a.prototype.hasViewFields=function(){return this.viewFields.length>0},a.prototype.getWhere=function(){return this.where},a.prototype.hasWhere=function(){return angular.isDefined(this.where)&&null!==this.where&&Object.getOwnPropertyNames(this.where)>0},a.prototype.getLimit=function(){return this.limit},a.prototype.hasLimit=function(){return angular.isDefined(this.where)&&null!==this.limit&&!isNaN(this.limit)&&this.limit>=0},a.prototype.getQuery=function(){return this.query},{parse:function(b){return new a(b)}}}),angular.module("ngSharepoint").factory("CamlTag",function(){var a=function(a,b,c){this.name=a,this.attr=b||{},this.value=c,this.caml=[]};return a.prototype.__buildTag=function(){var a=this,b="<";return b+=a.name,Object.getOwnPropertyNames(a.attr).length>0&&Object.getOwnPropertyNames(a.attr).forEach(function(c){b+=" ",b+=c,b+="=",b+='"'+a.attr[c]+'"'}),0===this.caml.length&&angular.isUndefined(this.value)?b+="/>":(b+=">",angular.isDefined(this.value)&&(b+=this.value)),b},a.prototype.findByName=function(a){var b=[];return this.caml.forEach(function(c){c.name===a&&b.push(c)}),b},a.prototype.push=function(b,c,d){var e;return e=b instanceof a?b:new a(b,c,d),this.caml.push(e),e},a.prototype.setValue=function(a){this.value=a},a.prototype.build=function(){for(var a=this.__buildTag(),b=0;b<this.caml.length;b++)a+=this.caml[b].build();return(this.caml.length>0||angular.isDefined(this.value))&&(a+="</"+this.name+">"),a},a}),angular.module("ngSharepoint").provider("$sp",$spProvider),angular.module("ngSharepoint").factory("$spLoader",["$q","$http","$sp","$spLog",function(a,b,c,d){var e={},f={};return f.loadScript=function(b){var d=a(function(a,d){var e=document.createElement("script");e.type="text/javascript",b[0]===b[1]&&"/"===b[0]?e.src=b:e.src=c.getSiteUrl()+"_layouts/15/"+b,e.onload=a,e.onerror=d,document.head.appendChild(e)});return e[b]=d,d},f.loadScripts=function(b,c){var d=[];c.forEach(function(a){d.push(f.loadScript(a))});var g=a.all(d);return e[b]=g,g},f.waitUntil=function(b){return a(function(a,d){e.hasOwnProperty(b)?e[b].then(a,d):c.getAutoload()?d("Library was not requested"):a()})},f.query=function(e){return a(function(a,d){b({method:"POST",url:c.getSiteUrl()+"_api/contextInfo",headers:{"X-FORMS_BASED_AUTH_ACCEPTED":"f",Accept:"application/json; odata=verbose","Content-Type":"application/json; odata=verbose"}}).then(function(g){var h={url:c.getSiteUrl()+e.url,method:e.method,headers:{"X-RequestDigest":g.d.GetContextWebInformation.FormDigestValue,Accept:"application/json; odata=verbose","Content-Type":"application/json; odata=verbose"}};"REST"!==c.getConnectionMode()||c.getAccessToken()?(e.hasOwnProperty("data")&&angular.isDefined(e.data)&&null!==e&&(h.data=e.data),h.headers.Authorization="Bearer "+c.getAccessToken(),b(h).then(a,d)):f.waitUntil("SP.RequestExecutor.js").then(function(){e.hasOwnProperty("data")&&angular.isDefined(e.data)&&null!==e&&(h.body=e.data),h.success=a,h.error=d,new SP.RequestExecutor(c.getSiteUrl()).executeAsync(h)})})})["catch"](d.error)},f}]),angular.module("ngSharepoint").provider("$spLog",function(){var a="[ngSharepoint] ",b=!0;return{setPrefix:function(a){this.prefix="["+a+"] "},setEnabled:function(a){this.enabled=a},$get:function(){return{error:function(c){b&&(angular.isObject(c)?console.error(a+"Object: %O",c):console.error(a+c))},warn:function(c){b&&(angular.isObject(c)?console.warn(a+"Object: %O",c):console.warn(a+c))},log:function(c){b&&(angular.isObject(c)?console.log(a+"Object: %O",c):console.log(a+c))}}}}}),angular.module("ngSharepoint.Lists",["ngSharepoint"]),angular.module("ngSharepoint.Lists").factory("JSOMConnector",["$q","$sp",function(a,b){return{getLists:function(){return a(function(a,c){var d=b.getContext(),e=d.get_web().get_lists();d.load(e),d.executeQueryAsync(function(b,c){for(var d=[],f=e.getEnumerator();f.moveNext();){var g=e.get_current();d.push(g)}a(d)},c)})}}}]),angular.module("ngSharepoint.Lists").factory("RESTConnector",["$q","$sp","$spLoader",function(a,b,c){return{getLists:function(){return a(function(a,b){})}}}]),angular.module("ngSharepoint.Lists").factory("JsomSPList",["$q","$sp","$spLoader","$spCamlParser",function(a,b,c,d){var e=function(a){this.title=a};return e.prototype.read=function(e){var f=this;return a(function(a,g){c.waitUntil("SP.Core").then(function(){var c=b.getContext(),h=c.get_web().get_lists().getByTitle(f.title),i=new SP.CamlQuery;i.set_viewXml(e);var j=h.getItems(i);c.load(j),c.executeQueryAsync(function(){for(var b=[],c=j.getEnumerator();c.moveNext();){var g=c.get_current();b.push(f.__unpack(g,d.parse(e).getViewFields()))}a(b)},function(a,b){g(b)})})})},e.prototype.create=function(d){var e=this;return a(function(a,f){c.waitUntil("SP.Core").then(function(){var c=b.getContext(),g=c.get_web().get_lists().getByTitle(e.title),h=new SP.ListItemCreationInformation,i=g.addItem(h);e.__pack(i,d),i.update(),c.load(i),c.executeQueryAsync(function(b,c){a(d)},function(a,b){f(b)})})})},e.prototype["delete"]=function(d){var e=this;return a(function(a,f){c.waitUntil("SP.Core").then(function(){var c=b.getContext(),g=c.get_web().get_lists().getByTitle(e.title),h=new SP.CamlQuery;h.set_viewXml(d);var i=g.getItems(h);c.load(i),c.executeQueryAsync(function(b,d){for(var e=i.getEnumerator(),g=[];e.moveNext();){var h=e.get_current();g.push(h)}g.forEach(function(a){a.deleteObject()}),c.executeQueryAsync(function(b,c){a(c)},function(a,b){f(b)})},function(a,b){f(b)})})})},e.prototype.update=function(d,e){var f=this;return a(function(a,g){c.waitUntil("SP.Core").then(function(){var c=b.getContext(),h=c.get_web().get_lists().getByTitle(f.__list),i=new SP.CamlQuery;i.set_viewXml(d);var j=h.getItems(i);c.load(j),c.executeQueryAsync(function(b,d){for(var h=j.getEnumerator();h.moveNext();){var i=h.get_current();f.__pack(i,e),i.update()}c.executeQueryAsync(function(b,c){a(c)},function(a,b){g(b)})},function(a,b){g(b)})})})},e.prototype.__pack=function(a,b){Object.getOwnPropertyNames(b).forEach(function(c){var d=b[c];angular.isDefined(d)&&null!==d&&angular.isString(d)&&(d=d.trim()),a.set_item(c,d)})},e.prototype.__unpack=function(a,b){var c={},d=b;return angular.isArray(b)||(d=Object.getOwnPropertyNames(b)),d.forEach(function(b){var d=a.get_item(b);angular.isDefined(d)&&null!==d&&angular.isString(d)&&(d=d.trim()),c[b]=d}),c},e}]),angular.module("ngSharepoint.Lists").factory("RestSPList",["$q","$sp","$spLoader",function(a,b,c){var d=function(a){this.title=a};return d.prototype.read=function(b){var d="_api/web/Lists/GetByTitle('"+this.title+"')/GetItems",e={query:{__metadata:{type:"SP.CamlQuery"},ViewXml:b}};return a(function(a,b){c.query({method:"POST",url:d,data:e}).then(function(a){},b)})},d.prototype.create=function(b){var d="_api/web/Lists/GetByTitle('"+this.title+"')/items",e={__metadata:{type:"SP.Data.TestListItem"}};return Object.getOwnPropertyNames(b).forEach(function(a){var c=b[a];angular.isDefined(c)&&null!==c&&angular.isString(c)&&(c=c.trim()),e[a]=c}),a(function(a,b){c.query({method:"POST",url:d,data:e}).then(function(a){},b)})},d.prototype["delete"]=function(a){},d.prototype.update=function(a,b){},d}]),angular.module("ngSharepoint.Lists").factory("SPList",["$sp","$spLog","CamlBuilder","RestSPList","JsomSPList",function(a,b,c,d,e){var f=function(b){this.title=b,"JSOM"===a.getConnectionMode()?this.__list=new e(b):this.__list=new d(b)};return f.prototype.create=function(a){return this.__list.create(a)["catch"](b.error)},f.prototype.read=function(a){return this.__list.read(a)["catch"](b.error)},f.prototype.update=function(a,c){return this.__list.update(a,c)["catch"](b.error)},f.prototype["delete"]=function(a){return this.__list["delete"](a)["catch"](b.error)},f.prototype.query=function(a){return angular.isObject(a)?this.__jsonQuery(a):void 0},f.prototype.__jsonQuery=function(a){if(!angular.isDefined(a.type))throw"Query Type is not defined";var b=new c;switch(b.buildFromJson(a),a.type){case"create":if(angular.isDefined(a.data))return this.create(a.data);throw"Query Data is not defined";case"read":return this.read(b.build());case"update":if(angular.isDefined(a.data))return this.update(b.build(),a.data);throw"Query Data is not defined";case"delete":return this["delete"](b.build())}},f}]),angular.module("ngSharepoint.Lists").factory("DeleteQuery",["SPList","CamlBuilder","WhereQuery","Query",function(a,b,c,d){var e=function(){return this.__where=[],this.__list=null,this};return e.prototype=new d,e.prototype.from=function(a){return this.__list=a,this},e.prototype.where=function(a){var b=new c(this,a);return this.__where.push(b),b},e.prototype.__execute=function(){var c,d=new b,e=d.push("View");if(1===this.__where.length)c=e.push("Query"),this.__where[0].push(c.push("Where"));else if(this.__where.length>1){c=e.push("Query");var f=c.push("Where").push("And");this.__where.forEach(function(a){a.push(f)})}return new a(this.__list)["delete"](d.build())},e}]),angular.module("ngSharepoint.Lists").factory("InsertIntoQuery",["SPList","Query",function(a,b){var c=function(a){return this.__list=a,this.__values={},this};return c.prototype=new b,c.prototype.value=function(a,b){return this.__values[a]=b,this},c.prototype.__execute=function(){return new a(this.__list).insert(this.__values)},c}]),angular.module("ngSharepoint.Lists").factory("JoinQuery",["$q","$sp",function(a,b){var c=function(){};return c}]),angular.module("ngSharepoint.Lists").factory("Query",function(){var a=function(){};return a.prototype.then=function(a,b){return this.__execute().then(a,b)},a}),angular.module("ngSharepoint.Lists").factory("SelectQuery",["SPList","CamlBuilder","Query","WhereQuery",function(a,b,c,d){var e=function(a){return this.__values=a,this.__where=[],this.__order=[],this};return e.prototype=new c,e.prototype.from=function(a){return this.__list=a,this},e.prototype.where=function(a){var b=new d(this,a);return this.__where.push(b),b},e.prototype.limit=function(a){return this.__limit=a,this},e.prototype.orderBy=function(a,b){return angular.isUndefined(b)&&(b=!0),this.__order.push({column:a,asc:b}),this},e.prototype.exec=function(){var c=new b,d={};return angular.isObject(this.__values)&&(d.columns=this.__values),angular.isDefined(this.__limit)&&(d.limit=this.__limit),angular.isDefined(this.__order)&&(d.order=this.__order),c.buildFromJson(d),new a(this.__list).read(c.build())},e.prototype.__execute=function(){var c=new b,d=c.push("View");if(this.__where.length>0||this.__order.length>0){var e=d.push("Query");if(1===this.__where.length){var f=e.push("Where");this.__where[0].push(f)}else if(this.__where.length>1){var g=e.push("Where").push("And");this.__where.forEach(function(a){a.push(g)})}if(this.__order.length>0){var h=e.push("OrderBy");this.__order.forEach(function(a){h.push("FieldRef",{Name:a.field,Ascending:a.asc})})}}var i=d.push("ViewFields");return this.__values.forEach(function(a){i.push("FieldRef",{Name:a})}),null!==this.__limit&&d.push("RowLimit",{},this.__limit),new a(this.__list).select(c.build())},e}]),angular.module("ngSharepoint.Lists").factory("UpdateQuery",["SPList","CamlBuilder","WhereQuery","Query",function(a,b,c,d){var e=function(a){return this.__list=a,this.__values={},this.__where=[],this};return e.prototype=new d,e.prototype.set=function(a,b){return this.__values[a]=b,this},e.prototype.where=function(a){var b=new c(this,a);return this.__where.push(b),b},e.prototype.__execute=function(){var c,d=new b,e=d.push("View");if(1===this.__where.length)c=e.push("Query"),this.__where[0].push(c.push("Where"));else if(this.__where.length>1){c=e.push("Query");var f=c.push("Where").push("And");this.__where.forEach(function(a){a.push(f)})}return new a(this.__list).update(d.build(),this.__values)},e}]),angular.module("ngSharepoint.Lists").factory("WhereQuery",function(){var a=function(a,b){this.__query=a,this.__value="",this.__operator="",this.__operators={BEGINS_WITH:["<BeginsWith>","</BeginsWith>"],CONTAINS:["<Contains>","</Contains>"],EQUALS:["<Eq>","</Eq>"],GREATER_EQUALS:["<Geq>","</Geq>"],GREATER:["<Gt>","</Gt>"],INCLUDES:["<Includes>","</Includes>"],IS_NOT_NULL:["<IsNotNull>","</IsNotNull>"],IS_NULL:["<IsNull>","</IsNull>"],LESS_EQUALS:["<Leq>","</Leq>"],LESS:["<Lt>","</Lt>"],NOT_EQUALS:["<Neq>","</Neq>"],NOT_INCLUDES:["<NotIncludes>","</NotIncludes>"]},angular.isString(b)?this.__field=b:(this.__fields=b,this.__operator="equals")};return a.prototype.equals=function(a){return this.__operator="equals",this.__value=a,this.__query},a.prototype.beginsWith=function(a){this.__operator=this.__operators.BEGINS_WITH},a.prototype.push=function(a){var b=this;if(angular.isUndefined(b.__fields)){var c;switch(b.__operator){case"equals":c=a.push("Eq")}c.push("FieldRef",{Name:b.__field}),c.push("Value",{Type:"Number"},b.__value)}else{var d=a.push("And");Object.getOwnPropertyNames(b.__fields).forEach(function(a){var c=d.push("Eq");c.push("FieldRef",{Name:a}),c.push("Value",{Type:"Number"},b.__fields[a])})}},a}),angular.module("ngSharepoint.Lists").factory("$query",$query),$query.$inject=["$spList"],angular.module("ngSharepoint.Lists").factory("$spList",$spList),$spList.$inject=["$sp","SPList","JSOMConnector","RESTConnector"],angular.module("ngSharepoint.Users",["ngSharepoint"]).run(["$sp","$spLoader",function(a,b){a.getAutoload()&&"JSOM"===a.getConnectionMode()&&b.loadScript("SP.Userprofiles.js")}]),angular.module("ngSharepoint.Users").factory("JsomSPUser",["$q","$sp","$spLoader",function(a,b,c){var d=function(a){this.accountName=a};return d.prototype.load=function(){var d=this;return a(function(a,e){c.waitUntil("SP.Userprofiles.js").then(function(){var c=b.getContext(),f=new SP.UserProfiles.PeopleManager(c),g=f.getPropertiesFor(d.accountName);c.load(g),c.executeQueryAsync(function(){var b={};b.displayName=g.get_displayName(),b.email=g.get_email(),b.picture=g.get_pictureUrl(),b.title=g.get_title(),b.personalUrl=g.get_personalUrl(),b.userUrl=g.get_userUrl(),a(b)},e)})})},d}]),angular.module("ngSharepoint.Users").factory("RestSPUser",["$q","$spLoader",function(a,b){var c=function(a){this.accountName=a};return c.prototype.load=function(){var c=this,d="_api/SP.UserProfiles.PeopleManager/getPropertiesFor(@account)?@account='"+c.accountName+"'";return a(function(a,c){b({method:"GET",url:d}).then(function(b){var c={};c.displayName=b.d.DisplayName,c.email=b.d.Email,c.picture=b.d.PictureUrl,c.title=b.d.Title,c.personalUrl=b.d.PersonalUrl,c.userUrl=b.d.UserUrl,a(c)},c)})},c}]),angular.module("ngSharepoint.Users").factory("SPUser",["$q","$spLoader","$sp","JsomSPUser","RestSPUser",function(a,b,c,d,e){var f=function(a,b){var f=this;return angular.isUndefined(b)&&(b=!0),f.accountName=a,"JSOM"===c.getConnectionMode()?f.__user=new d(a):f.__user=new e(a),b?f.load().then(function(a){f.from(a)}):f};return f.prototype.from=function(a){this.displayName=a.displayName,this.email=a.email,this.picture=a.picture,this.title=a.title,this.personalUrl=a.personalUrl,this.userUrl=a.userUrl,this.properties=a.properties},f.prototype.load=function(){return this.__user.load()},f}]),angular.module("ngSharepoint.Users").factory("$spUser",["$q","$sp","SPUser",function(a,b,c){return{getCurrentUser:function(){return a(function(a,c){var d=b.getContext(),e=new SP.UserProfiles.PeopleManager(d),f=e.getMyProperties();d.load(f),d.executeQueryAsync(function(){a(f)},c)})},getUser:function(a){return new c(a)}}}]);